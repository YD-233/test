import"./index-88aec585.js";/* empty css               *//* empty css                  *//* empty css                   */import{T as K}from"./TablesView-74e54e65.js";import{H as Z,aB as J,ay as Q,r as C,w as W,d as X,Z as Y,_ as ee,$ as te,A as oe,l as z,m as k,p as a,V as s,P as o,u as v,T as i,F as le,a8 as ae,K as N,U as p}from"./vue-95bbca75.js";import{C as w}from"./index-926bd281.js";import{a as m,b as S,o as se,p as ne,q as re,r as ie,s as pe}from"./element-61b2a7f7.js";/* empty css                 *//* empty css                  *//* empty css                    */const ue={class:"color-picker"},de={class:"dialog-footer"},xe=Z({__name:"ClientsView",setup(ce){const h=J(),x=Q();C();const u=C(!1),g=C(!1),d=C(""),V=["#f31616","#09e609","#0b0be6","#e8e807","#e10fe1","#12dada"];let c="";const P=()=>{d.value=""},E=()=>{d.value="",g.value=!1},O=async()=>{d.value&&(await w.select_color({uid:c,color:d.value})).data.status===200&&m.success("修改颜色成功"),g.value=!1,u.value=!1},_=C([]),n={page:Number(h.query.page)||1,pageSize:Number(h.query.pageSize)||10},T=(l=1,t=10)=>w.get_clients_list({page:l,page_size:t});W(()=>h.query,async l=>{const{page:t,pageSize:r}=l;n.page=Number(t)||n.page,n.pageSize=Number(r)||n.pageSize,T(n.page,n.pageSize).then(f=>{_.value=f.data.data.list,y.options.paginationConfig={total:f.data.data.total,currentPage:n.page,pageSize:n.pageSize,pageSizes:[10,50,100,1e3],layout:"total,prev, pager, next,sizes"}})},{immediate:!0});function B(){T(n.page,n.pageSize).then(l=>{_.value=l.data.data.list,y.options.paginationConfig={total:l.data.data.total,currentPage:n.page,pageSize:n.pageSize,pageSizes:[10,50,100,1e3],layout:"total,prev, pager, next,sizes"}})}X(async()=>{const l=setInterval(B,2e3);Y(()=>{clearInterval(l)})});const A=[{prop:"FirstStart",label:"FirstStart",showOverflowTooltip:!0,Color:"Color",width:"130"},{prop:"ExternalIP",label:"外网IP",showOverflowTooltip:!0,Color:"Color",width:"130"},{prop:"Username",label:"User",showOverflowTooltip:!0,width:"170",Color:"Color"},{prop:"Computer",label:"Computer",showOverflowTooltip:!0,width:"170",Color:"Color"},{prop:"Process",label:"Process",showOverflowTooltip:!0,Color:"Color"},{prop:"Pid",label:"Pid",showOverflowTooltip:!0,Color:"Color"},{prop:"Address",label:"Address",showOverflowTooltip:!0,Color:"Color",width:"200"},{prop:"Arch",label:"Arch",showOverflowTooltip:!0,width:"60",Color:"Color"},{prop:"Note",label:"Note",showOverflowTooltip:!0,Color:"Color",width:"120"},{prop:"Sleep",label:"Sleep",showOverflowTooltip:!0,width:"65",Color:"Color"},{label:"Online",slot:"onlineStatus",width:"80",align:"center",Color:"Color"},{label:"操作",buttons:[],slot:"action",Color:"Color"}],U=l=>{u.value=!0,c=l.Uid},I=async l=>{const{value:t}=await S.prompt("输入Note","Note",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"Note"});if(!t){m.warning("Note不能为空");return}(await w.add_uid_note({uid:l,note:t})).data.status===200&&m.success("Note成功"),u.value=!1},R=async l=>{const{value:t}=await S.prompt("Sleep",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"Sleep"});if(!t){m.warning("Sleep不能为空");return}(await w.edit_sleep({uid:l,sleep:t})).data.status===200&&m.success("修改Sleep成功"),u.value=!1},$=async l=>{g.value=!0},q=l=>{S.confirm("是否退出客户端?","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await w.do_exit({uid:l})).data.status===200&&m.success("退出成功"),u.value=!1})},F=l=>{x.push({path:"/client/shell",query:{uid:l.Uid}})},y=ee({options:{showPagination:!0}}),{options:M}=te(y),D=oe("reload"),G=async(l,t)=>{await x.push({path:h.path,query:{page:l,pageSize:t}}),D()};return(l,t)=>{const r=se,f=ne,L=pe,j=re,H=ie;return z(),k("div",null,[a("div",null,[s(f,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=e=>u.value=e),width:"30%"},{default:o(()=>[s(r,{type:"primary",onClick:t[0]||(t[0]=e=>I(v(c)))},{default:o(()=>[i("Note")]),_:1}),s(r,{type:"success",onClick:t[1]||(t[1]=e=>$(v(c)))},{default:o(()=>[i("Color")]),_:1}),s(r,{type:"warning",onClick:t[2]||(t[2]=e=>R(v(c)))},{default:o(()=>[i("Sleep")]),_:1}),s(r,{type:"danger",onClick:t[3]||(t[3]=e=>q(v(c)))},{default:o(()=>[i("Exit")]),_:1})]),_:1},8,["modelValue"]),s(f,{modelValue:g.value,"onUpdate:modelValue":t[6]||(t[6]=e=>g.value=e),title:"选择颜色",width:"30%",onClose:P},{footer:o(()=>[a("span",de,[s(r,{onClick:E},{default:o(()=>[i("取 消")]),_:1}),s(r,{type:"primary",onClick:O},{default:o(()=>[i("确 定")]),_:1})])]),default:o(()=>[a("div",ue,[s(j,{modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=e=>d.value=e)},{default:o(()=>[(z(),k(le,null,ae(V,(e,b)=>s(L,{key:b,label:e,style:{display:"block",margin:"10px 0"}},{default:o(()=>[a("span",{style:N({background:e,display:"inline-block",width:"20px",height:"20px",borderRadius:"50%"})},null,4)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"]),a("div",null,[s(K,{columns:A,"table-data":_.value,options:v(M),onPaginationChange:G},{FirstStart:o(({row:e})=>[a("span",{style:N({color:e.Color})},p(e.FirstStart),5)]),ExternalIP:o(({row:e})=>[a("span",null,p(e.ExternalIP),1)]),Username:o(({row:e})=>[a("span",null,p(e.Username),1)]),Computer:o(({row:e})=>[a("span",null,p(e.Computer),1)]),Address:o(({row:e})=>[a("span",null,p(e.Address),1)]),Arch:o(({row:e})=>[a("span",null,p(e.Arch),1)]),Note:o(({row:e})=>[a("span",null,p(e.Note),1)]),Sleep:o(({row:e})=>[a("span",null,p(e.Sleep),1)]),onlineStatus:o(({row:e})=>[s(H,{type:e.Online==="1"?"success":"danger",size:"small"},{default:o(()=>[i(p(e.Online==="1"?"在线":"离线"),1)]),_:2},1032,["type"])]),action:o(({row:e})=>[a("div",null,[s(r,{type:"primary",onClick:b=>F(e),size:"small"},{default:o(()=>[i("查看")]),_:2},1032,["onClick"]),s(r,{type:"success",onClick:b=>U(e),size:"small"},{default:o(()=>[i("更多操作")]),_:2},1032,["onClick"])])]),_:1},8,["table-data","options"])])])])}}});export{xe as default};
