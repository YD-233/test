import{s as b}from"./index-88aec585.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                    */import{a as u,o as D,t as U,r as B,u as I,v as $,w as K,x as F,y as H,z as M,p as G}from"./element-61b2a7f7.js";import{H as W,r as A,d as j,l as y,m as q,V as e,P as a,T as c,U as J,O as k,S as L,p as S}from"./vue-95bbca75.js";const p={addListener(d){return b({url:"/listener/add",method:"POST",data:d})},getListenerList(){return b({url:"/listener/list",method:"GET"})},openListener(d){return b({url:"/listener/open",method:"POST",data:d})},closeListener(d){return b({url:"/listener/close",method:"POST",data:d})},deleteListener(d){return b({url:"/listener/delete",method:"POST",data:d})}},Q=S("br",null,null,-1),R=S("br",null,null,-1),re=W({__name:"listener",setup(d){const V=A([]),l=A({protocol:"websocket",listenAddress:"",connectAddress:""}),r=A({endpoint:"oss-cn-hangzhou.aliyuncs.com",bucketName:"alisso"}),m=A(!1),n=async()=>{const o=await p.getListenerList();o.status===200&&(V.value=o.data.data)},g=async()=>{l.value.protocol==="oss"?((await p.addListener({type:l.value.protocol,listenAddress:r.value.endpoint+":"+l.value.listenAddress+":"+l.value.connectAddress+":"+r.value.bucketName,connectAddress:r.value.endpoint+":"+l.value.listenAddress+":"+l.value.connectAddress+":"+r.value.bucketName})).status===200&&(u.success("添加成功"),await n()),m.value=!1):((await p.addListener({type:l.value.protocol,listenAddress:l.value.listenAddress,connectAddress:l.value.connectAddress})).status===200&&(u.success("添加成功"),await n()),m.value=!1)},E=async o=>{const t=await p.openListener({listenAddress:o.ListenAddress});t.data.status===200?(await n(),u.success("开启监听成功")):(await n(),u.error(t.data.data))},T=async o=>{const t=await p.closeListener({listenAddress:o.ListenAddress});t.data.status===200?(await n(),u.success("关闭监听成功")):(await n(),u.error(t.data.data))},h=async o=>{const t=await p.deleteListener({listenAddress:o.ListenAddress});t.data.status===200?(await n(),u.success("删除监听成功")):(await n(),u.error(t.data.data))};return j(async()=>{await n()}),(o,t)=>{const v=D,_=U,x=B,N=I,f=$,P=K,i=F,w=H,O=M,z=G;return y(),q("div",null,[e(v,{size:"large",type:"primary",onClick:t[0]||(t[0]=s=>m.value=!0)},{default:a(()=>[c("添加Listener")]),_:1}),Q,R,e(N,{data:V.value},{default:a(()=>[e(_,{prop:"Type",label:"类型"}),e(_,{prop:"ListenAddress",label:"监听地址"}),e(_,{prop:"ConnectAddress",label:"连接地址"}),e(_,{label:"状态",prop:"Status"},{default:a(({row:s})=>[e(x,{type:s.Status===1?"success":"danger",size:"default"},{default:a(()=>[c(J(s.Status===1?"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"操作"},{default:a(s=>[s.row.Status===2?(y(),k(v,{key:0,size:"small",type:"success",onClick:C=>E(s.row)},{default:a(()=>[c("开启")]),_:2},1032,["onClick"])):L("",!0),s.row.Status===1?(y(),k(v,{key:1,size:"small",type:"primary",onClick:C=>T(s.row)},{default:a(()=>[c("关闭")]),_:2},1032,["onClick"])):L("",!0),e(v,{size:"small",type:"danger",onClick:C=>h(s.row)},{default:a(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(z,{modelValue:m.value,"onUpdate:modelValue":t[6]||(t[6]=s=>m.value=s),title:"添加Listener",width:"500px"},{default:a(()=>[e(O,{model:l.value,"label-width":"120px"},{default:a(()=>[e(i,{label:"协议"},{default:a(()=>[e(P,{modelValue:l.value.protocol,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.protocol=s),placeholder:"请选择协议"},{default:a(()=>[e(f,{label:"Websocket",value:"websocket"}),e(f,{label:"TCP",value:"tcp"}),e(f,{label:"KCP",value:"kcp"}),e(f,{label:"HTTP",value:"http"}),e(f,{label:"OSS",value:"oss"})]),_:1},8,["modelValue"])]),_:1}),l.value.protocol==="oss"?(y(),k(i,{key:0,label:"EndPoint"},{default:a(()=>[e(w,{modelValue:r.value.endpoint,"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.endpoint=s),style:{width:"300px"}},null,8,["modelValue"])]),_:1})):L("",!0),e(i,{label:l.value.protocol==="oss"?"AccessKeyId":"监听地址"},{default:a(()=>[e(w,{modelValue:l.value.listenAddress,"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.listenAddress=s),placeholder:l.value.protocol==="oss"?"":"0.0.0.0:8083",style:{width:"300px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(i,{label:l.value.protocol==="oss"?"AccessKeySecret":"连接地址"},{default:a(()=>[e(w,{modelValue:l.value.connectAddress,"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.connectAddress=s),placeholder:l.value.protocol==="oss"?"":"外网连接地址（127.0.0.1:8083)",style:{width:"300px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.protocol==="oss"?(y(),k(i,{key:1,label:"BucketName"},{default:a(()=>[e(w,{modelValue:r.value.bucketName,"onUpdate:modelValue":t[5]||(t[5]=s=>r.value.bucketName=s),style:{width:"300px"}},null,8,["modelValue"])]),_:1})):L("",!0),e(i,null,{default:a(()=>[e(v,{type:"primary",onClick:g},{default:a(()=>[c("添加")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{re as default};
